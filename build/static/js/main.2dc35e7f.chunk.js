(this["webpackJsonpmusic-app"]=this["webpackJsonpmusic-app"]||[]).push([[0],{29:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(23),s=n.n(c),r=(n(29),n(15)),o=n(12),i=n(4),l=Object(a.createContext)(),u=Object(a.createContext)(),j=n(3),p=n.n(j),d=n(10),b=n(6),h=function(){var e=Object(b.a)(p.a.mark((function e(t,n){var a,c,s,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,5,a=AbortController.signal,e.next=5,fetch("".concat("https://api.spotify.com/v1/browse/categories","/").concat(n,"/playlists?limit=").concat(5),{signal:a,method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 5:return c=e.sent,e.next=8,c.json();case 8:if(s=e.sent,void 0!==(r=s.playlists)){e.next=12;break}return e.abrupt("return",[]);case 12:return e.abrupt("return",r.items);case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}(),O=Object(a.createContext)(),g="[auth] get token",f="[categories] set lists of categories",m="[categories] set active category",x="[playlists] set active playlist",v="[playlists] set playlists",y="[playlists] clear playlists",k="[playlists] deactivate selected",w="[songs] set songs",C="[songs] set active song",N="[songs] songs is loading",S="[songs] songs finish loading",_="[songs] clear songs",A=n(0),I=function(e){var t=e.name,n=e.imgUrl,c=e.id,s=Object(a.useContext)(u).categoriesDispatch,r=Object(a.useContext)(l).authState.token,o=Object(i.f)(),j=function(e,t){var n=Object(a.useContext)(O).playlistDispatch,c=new AbortController;return Object(b.a)(p.a.mark((function a(){var s;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,h(e,t);case 3:s=a.sent,n({type:v,payload:Object(d.a)(s)}),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),c.abort(),console.log(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))}(r,c);return Object(A.jsx)("div",{onClick:function(){j(),s({type:m,payload:{id:c,name:t}}),o.push("/playlists/".concat(c))},className:"category-card hvr-grow",style:{backgroundImage:'url("'.concat(n,'")')},children:Object(A.jsx)("h2",{children:t})})},D=function(){var e=Object(b.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa("e0464f06b92e43eaa958c219757907ab:16bced7e2e5f4c55972433ce698828ec")},body:"grant_type=client_credentials"});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,a=n.access_token,localStorage.setItem("authToken",a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(b.a)(p.a.mark((function e(){var t,n,a,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return t=e.sent,n=AbortController.signal,e.next=6,fetch("https://api.spotify.com/v1/browse/categories",{signal:n,method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 6:return a=e.sent,e.next=9,a.json();case 9:return c=e.sent,s=c.categories,e.abrupt("return",{token:t,categories:s.items});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){return{type:g,payload:e}},P=function(){(function(){var e=Object(a.useContext)(u).categoriesDispatch,t=Object(a.useContext)(l).authDispatch;return Object(b.a)(p.a.mark((function n(){var a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T();case 3:a=n.sent,t(E(a.token)),e({type:f,payload:a.categories}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))})()();var e=Object(a.useContext)(u).categoriesState.categories;return Object(A.jsx)("div",{className:"category-container",children:e.slice(12).map((function(e){var t=e.name,n=e.id,a=e.icons;return Object(A.jsx)(I,{name:t,imgUrl:a[0].url,id:n},n)}))})},B=function(){return Object(A.jsxs)("footer",{className:"footer",children:[Object(A.jsx)("a",{href:"https://github.com/AlejoVE",target:"_blank",rel:"noreferrer",children:Object(A.jsx)("img",{src:"https://user-images.githubusercontent.com/59319966/109864628-584d4e80-7c63-11eb-9f1a-4afed77758ce.png",alt:"github logo"})}),Object(A.jsx)("p",{children:"Alejandro Montilla \xa9 2021"})]})},L=function(){return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)("div",{className:"main-container animate__animated animate__fadeIn",children:[Object(A.jsx)("div",{className:"header-container",children:Object(A.jsx)("img",{className:"header-img",src:"https://storage.googleapis.com/pr-newsroom-wp/1/2018/11/Spotify_Logo_CMYK_Black.png",alt:"Spotify logo"})}),Object(A.jsx)(P,{}),Object(A.jsx)(B,{})]})})},M=function(){return Object(A.jsxs)("div",{className:"not-selected-container animate__animated animate__fadeIn",children:[Object(A.jsx)("h2",{children:"Please select a Playlist"}),Object(A.jsx)("img",{src:"https://www.freepnglogos.com/uploads/spotify-logo-png/file-spotify-logo-png-4.png",alt:"Spotify logo"})]})},z=Object(a.createContext)(),R=function(){var e=Object(b.a)(p.a.mark((function e(t,n){var a,c,s,r,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 100,a=AbortController.signal,e.prev=2,e.next=5,fetch("".concat("https://api.spotify.com/v1/playlists","/").concat(n,"/tracks?limit=").concat(100),{signal:a,method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 5:return c=e.sent,e.next=8,c.json();case 8:return s=e.sent,r=s.items,o=[],r.forEach((function(e){var t=e.track,n=t.album,a=t.artists,c=t.id,s=t.name;o.push({album:n,artists:a,id:c,name:s})})),e.abrupt("return",o);case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(e){return{type:w,payload:e}},Z=function(e){var t=e.value,n=e.id,c=Object(a.useContext)(z).songsDispatch,s=Object(a.useContext)(O).playlistDispatch,r=function(e,t){var n=Object(a.useContext)(z).songsDispatch,c=new AbortController;return Object(b.a)(p.a.mark((function a(){var s;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,R(e,t);case 3:s=a.sent,n(Y(s)),a.next=12;break;case 7:a.prev=7,a.t0=a.catch(0),n({type:S}),c.abort(),console.log(a.t0);case 12:case"end":return a.stop()}}),a,null,[[0,7]])})))}(Object(a.useContext)(l).authState.token,n);return Object(A.jsx)("button",{className:"btn hvr-grow",onClick:function(){r(),s({type:x,payload:n}),c({type:N}),c({type:_})},children:t})},G=function(e){var t=e.name,n=e.description,a=e.tracks,c=e.id;return Object(A.jsxs)("li",{className:"li-element",children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("h2",{children:t}),Object(A.jsx)("p",{children:n}),Object(A.jsxs)("em",{children:["Number of songs: ",a.total]})]}),Object(A.jsx)(Z,{value:"See songs >>>",id:c})]})},V=function(e){var t=e.history,n=Object(a.useContext)(u).categoriesState.activeCategory.name,c=Object(a.useContext)(O),s=c.playlistsState,r=c.playlistDispatch,o=s.playlists,i=Object(a.useContext)(z).songsDispatch;return Object(A.jsxs)("div",{className:"playlists-container ",children:[Object(A.jsx)("div",{className:"header",children:Object(A.jsx)("h2",{children:n})}),Object(A.jsx)("ul",{className:"list",children:o.map((function(e){var t=e.id,n=e.name,a=e.description,c=e.tracks;return Object(A.jsx)(G,{name:n,description:a,tracks:c,id:t},t)}))}),Object(A.jsx)("button",{className:"goBack hvr-grow",onClick:function(){r({type:k}),i({type:_}),t.push("/")},children:"< Go back"})]})},J=function(){return Object(A.jsx)("div",{className:"loading-container",children:Object(A.jsx)("h2",{children:"Loading..."})})},Q=function(e){var t=e.name,n=e.artists,c=e.album,s=e.id,r=e.index,l=Object(a.useContext)(u).categoriesState.activeCategory.id,j=Object(a.useContext)(z).songsDispatch,p=Object(i.f)();return Object(A.jsx)("li",{className:"hvr-mine animate__animated animate__fadeIn",onClick:function(){j({type:C,payload:{name:t,artists:n,album:c,id:s}}),p.push("/playlists/".concat(l,"/song"))},children:Object(A.jsx)(o.b,{to:"/playlists/".concat(l,"/song"),children:"".concat(r,".                ").concat(t)})})},U=function(){var e=Object(a.useContext)(z),t=e.songsState,n=e.songsDispatch,c=t.songsIsLoading,s=t.songs;return Object(a.useEffect)((function(){n({type:w,payload:s})}),[n]),Object(A.jsx)("div",{className:"songs-container",children:Object(A.jsx)("ul",{children:c?Object(A.jsx)(J,{}):s.map((function(e,t){var n=e.name,a=e.album,c=e.artists,s=e.id;return Object(A.jsx)(Q,{name:n,album:a,artists:c,id:s,index:t+1},s)}))})})},W=function(e){var t=e.history,n=Object(a.useContext)(O).playlistsState.isSelected;return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)("div",{className:"playlists-screen-container",children:[Object(A.jsx)(V,{history:t}),n?Object(A.jsx)(U,{}):Object(A.jsx)(M,{})]})})},q=n(21),F=n.n(q),H=function(){var e=Object(b.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://accounts.spotify.com/api/token",{body:"grant_type=refresh_token&refresh_token=".concat("AQBjLvoOLQkYJeQx4HY033dXZBmbk8v3Jb_PykVhOsdE1n9I0Z6jxEgmcSeQi9pBSvRwuZWT9wEH33oMjKrgYv2teiSrSe2shgVbz8v0immvMy7jrxnfkaRldwuduW3-2qY"),headers:{Authorization:"Basic ".concat("ZTA0NjRmMDZiOTJlNDNlYWE5NThjMjE5NzU3OTA3YWI6MTZiY2VkN2UyZTVmNGM1NTk3MjQzM2NlNjk4ODI4ZWM="),"Content-Type":"application/x-www-form-urlencoded"},method:"POST"});case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(b.a)(p.a.mark((function e(t){var n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return n=e.sent,a=n.access_token,c=encodeURIComponent("spotify:track:".concat(t)),e.prev=5,e.next=8,fetch("".concat("https://api.spotify.com/v1/playlists/4qhYOIILXPZGcwOAOd9Vt6/","tracks?uris=").concat(c),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}});case 8:F.a.fire("Good choice!","Check your playlist ;)","success"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),F.a.fire("Error","Sorry, there was an error, try later","error"),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(i.f)(),t=Object(a.useContext)(u).categoriesState.activeCategory.id,n=Object(a.useContext)(z).songsState.activeSong,c=n.album,s=n.id,r=n.name,o=n.artists,l=c.images,j=c.name,p=c.release_date,d=function(e){var t=[];return e.forEach((function(e){return t.push(e.name)})),t.join(", ")}(o);return Object(A.jsxs)("div",{className:"song-screen-container animate__animated animate__fadeInLeft animate__faster",children:[Object(A.jsxs)("div",{className:"song-card-container ",children:[Object(A.jsx)("img",{src:"".concat(l[0].url),alt:"Album cover"}),Object(A.jsxs)("div",{className:"song-description-container",children:[Object(A.jsx)("div",{className:"song-header",children:Object(A.jsx)("h2",{children:r})}),Object(A.jsxs)("ul",{children:[Object(A.jsxs)("li",{children:["Artists: ",d]}),Object(A.jsxs)("li",{children:["Album: ",j]}),Object(A.jsxs)("li",{children:["Release date: ",p]})]}),Object(A.jsxs)("div",{className:"buttons-container",children:[Object(A.jsx)("button",{className:"go-back hvr-grow",onClick:function(){e.push("/playlists/".concat(t))},children:"< Go back"}),Object(A.jsx)("button",{className:"button hvr-grow",onClick:function(){K(s)},children:"Add song to Playlist"})]})]})]}),Object(A.jsx)(B,{})]})},$=function(){return Object(A.jsx)(o.a,{children:Object(A.jsx)("div",{children:Object(A.jsxs)(i.c,{children:[Object(A.jsx)(i.a,{exact:!0,path:"/main",component:L}),Object(A.jsx)(i.a,{exact:!0,path:"/playlists/:name",component:W}),Object(A.jsx)(i.a,{exact:!0,path:"/playlists/:name/song",component:X}),Object(A.jsx)(i.a,{exact:!0,path:"/",component:L})]})})})},ee=n(2),te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(ee.a)(Object(ee.a)({},e),{},{activePlaylistId:t.payload,isSelected:!0});case k:return Object(ee.a)(Object(ee.a)({},e),{},{isSelected:!1});case v:return Object(ee.a)(Object(ee.a)({},e),{},{playlists:Object(d.a)(t.payload)});case y:return Object(ee.a)(Object(ee.a)({},e),{},{playlists:[]});default:return e}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(ee.a)(Object(ee.a)({},e),{},{categories:Object(d.a)(t.payload)});case m:return Object(ee.a)(Object(ee.a)({},e),{},{activeCategory:t.payload});default:return e}},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(ee.a)(Object(ee.a)({},e),{},{token:t.payload});default:return e}},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(ee.a)(Object(ee.a)({},e),{},{songs:Object(d.a)(t.payload),songsIsLoading:!1});case N:return Object(ee.a)(Object(ee.a)({},e),{},{songsIsLoading:!0});case C:return Object(ee.a)(Object(ee.a)({},e),{},{activeSong:t.payload});case _:return Object(ee.a)(Object(ee.a)({},e),{},{songs:[]});case S:return Object(ee.a)(Object(ee.a)({},e),{},{songsIsLoading:!1});default:return e}},se=function(){return{activePlaylistId:"",isSelected:!1,playlists:[]}},re=function(){return{activeCategory:"",categories:[]}},oe=function(){return{token:""}},ie=function(){return{songs:[],songsIsLoading:!0,activeSong:{}}},le=function(){var e=Object(a.useReducer)(te,{},se),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(a.useReducer)(ne,{},re),o=Object(r.a)(s,2),i=o[0],j=o[1],p=Object(a.useReducer)(ae,{},oe),d=Object(r.a)(p,2),b=d[0],h=d[1],g=Object(a.useReducer)(ce,{},ie),f=Object(r.a)(g,2),m=f[0],x=f[1];return Object(A.jsx)(l.Provider,{value:{authState:b,authDispatch:h},children:Object(A.jsx)(z.Provider,{value:{songsState:m,songsDispatch:x},children:Object(A.jsx)(u.Provider,{value:{categoriesState:i,categoriesDispatch:j},children:Object(A.jsx)(O.Provider,{value:{playlistsState:n,playlistDispatch:c},children:Object(A.jsx)($,{})})})})})};s.a.render(Object(A.jsx)(le,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.2dc35e7f.chunk.js.map